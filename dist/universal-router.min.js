/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.UniversalRouter=t()}(this,function(){"use strict";var e=v,t=l,r=function(e,t){return p(l(e,t))},n=p,o=h,a="/",i="./",u=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function l(e,t){for(var r,n=[],o=0,l=0,p="",c=t&&t.delimiter||a,h=t&&t.delimiters||i,v=!1;null!==(r=u.exec(e));){var d=r[0],g=r[1],m=r.index;if(p+=e.slice(l,m),l=m+d.length,g)p+=g[1],v=!0;else{var y="",x=e[l],b=r[2],w=r[3],E=r[4],j=r[5];if(!v&&p.length){var R=p.length-1;h.indexOf(p[R])>-1&&(y=p[R],p=p.slice(0,R))}p&&(n.push(p),p="",v=!1);var O=""!==y&&void 0!==x&&x!==y,k="+"===j||"*"===j,T="?"===j||"*"===j,A=y||c,U=w||E;n.push({name:b||o++,prefix:y,delimiter:A,optional:T,repeat:k,partial:O,pattern:U?f(U):"[^"+s(A)+"]+?"})}}return(p||l<e.length)&&n.push(p+e.substr(l)),n}function p(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var o="",a=n&&n.encode||encodeURIComponent,i=0;i<e.length;i++){var u=e[i];if("string"!=typeof u){var l,p=r?r[u.name]:void 0;if(Array.isArray(p)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but got array');if(0===p.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var s=0;s<p.length;s++){if(l=a(p[s]),!t[i].test(l))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'"');o+=(0===s?u.prefix:u.delimiter)+l}}else if("string"!=typeof p&&"number"!=typeof p&&"boolean"!=typeof p){if(!u.optional)throw new TypeError('Expected "'+u.name+'" to be '+(u.repeat?"an array":"a string"));u.partial&&(o+=u.prefix)}else{if(l=a(String(p)),!t[i].test(l))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but got "'+l+'"');o+=u.prefix+l}}else o+=u}return o}}function s(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function f(e){return e.replace(/([=!:$/()])/g,"\\$1")}function c(e){return e&&e.sensitive?"":"i"}function h(e,t,r){for(var n=(r=r||{}).strict,o=!1!==r.end,u=s(r.delimiter||a),l=r.delimiters||i,p=[].concat(r.endsWith||[]).map(s).concat("$").join("|"),f="",h=!1,v=0;v<e.length;v++){var d=e[v];if("string"==typeof d)f+=s(d),h=v===e.length-1&&l.indexOf(d[d.length-1])>-1;else{var g=s(d.prefix),m=d.repeat?"(?:"+d.pattern+")(?:"+g+"(?:"+d.pattern+"))*":d.pattern;t&&t.push(d),d.optional?d.partial?f+=g+"("+m+")?":f+="(?:"+g+"("+m+"))?":f+=g+"("+m+")"}}return o?(n||(f+="(?:"+u+")?"),f+="$"===p?"$":"(?="+p+")"):(n||(f+="(?:"+u+"(?="+p+"))?"),h||(f+="(?="+u+"|"+p+")")),new RegExp("^"+f,c(r))}function v(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(v(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",c(r))}(e,t,r):function(e,t,r){return h(l(e,r),t,r)}(e,t,r)}e.parse=t,e.compile=r,e.tokensToFunction=n,e.tokensToRegExp=o;var d=Object.prototype.hasOwnProperty,g=new Map;function m(e){try{return decodeURIComponent(e)}catch(t){return e}}function y(t,r,n,o,a){var i,u,l=0;return{next:function(p){if(t===p)return{done:!0};if(!i&&(i=function(t,r,n,o){var a=!t.children,i=(t.path||"")+"|"+a,u=g.get(i);if(!u){var l=[];u={keys:l,pattern:e(t.path||"",l,{end:a})},g.set(i,u)}var p=u.pattern.exec(r);if(!p)return null;for(var s=p[0],f=Object.assign({},o),c=1;c<p.length;c++){var h=u.keys[c-1],v=h.name,y=p[c];void 0===y&&d.call(f,v)||(h.repeat?f[v]=y?y.split(h.delimiter).map(m):[]:f[v]=y?m(y):y)}return{path:a||"/"!==s.charAt(s.length-1)?s:s.substr(1),keys:n.concat(u.keys),params:f}}(t,n,o,a)))return{done:!1,value:{route:t,baseUrl:r,path:i.path,keys:i.keys,params:i.params}};if(i&&t.children)for(;l<t.children.length;){if(!u){var s=t.children[l];s.parent=t,u=y(s,r+i.path,n.substr(i.path.length),i.keys,i.params)}var f=u.next(p);if(!f.done)return{done:!1,value:f.value};u=null,l++}return{done:!0}}}}function x(e,t){if("function"==typeof e.route.action)return e.route.action(e,t)}var b=function(){function e(e,t){if(void 0===t&&(t={}),Object(e)!==e)throw new TypeError("Invalid routes");this.baseUrl=t.baseUrl||"",this.resolveRoute=t.resolveRoute||x,this.context=Object.assign({router:this},t.context),this.root=Array.isArray(e)?{path:"",children:e,parent:null}:e,this.root.parent=null}return e.prototype.resolve=function(e){var t=Object.assign({},this.context,"string"==typeof e?{pathname:e}:e),r=y(this.root,this.baseUrl,t.pathname.substr(this.baseUrl.length),[],null),n=this.resolveRoute,o=null,a=null;function i(e,u,l){void 0===u&&(u=o.value.route);var p=null===l&&o.value.route;return o=a||r.next(p),a=null,e||!o.done&&function(e,t){for(var r=t;r;)if((r=r.parent)===e)return!0;return!1}(u,o.value.route)?o.done?Promise.reject(Object.assign(new Error("Page not found"),{context:t,status:404,statusCode:404})):Promise.resolve(n(Object.assign({},t,o.value),o.value.params)).then(function(t){return null!==t&&void 0!==t?t:i(e,u,t)}):(a=o,Promise.resolve(null))}return t.next=i,i(!0,this.root)},e}();return b.pathToRegexp=e,b});
//# sourceMappingURL=universal-router.min.js.map
